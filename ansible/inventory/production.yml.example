# CIRISBridge Production Inventory - Active/Active
# This file is auto-generated by Terraform
# Copy to production.yml and update with actual IPs
#
# Both nodes are equal peers - no primary/secondary distinction

all:
  children:
    us:
      hosts:
        vultr:
          ansible_host: 1.2.3.4  # Replace with Vultr IP
          ansible_user: root
          region: us
          node_name: us
          peer_ip: 5.6.7.8  # EU node IP
          dns_soa: ciris-services-1.ai
          geo_continents: ["NA", "SA", "OC"]

    eu:
      hosts:
        hetzner:
          ansible_host: 5.6.7.8  # Replace with Hetzner IP
          ansible_user: root
          region: eu
          node_name: eu
          peer_ip: 1.2.3.4  # US node IP
          dns_soa: ciris-services-2.ai
          volume_device: /dev/sdb  # Hetzner volume device
          geo_continents: ["EU", "AF", "AS"]

  vars:
    # Topology
    topology: active_active

    # IP addresses
    us_ip: 1.2.3.4
    eu_ip: 5.6.7.8

    # Legacy aliases (for backwards compatibility)
    vultr_ip: 1.2.3.4
    hetzner_ip: 5.6.7.8

    # Domains
    primary_domain: ciris-services-1.ai
    secondary_domain: ciris-services-2.ai
    admin_email: admin@ciris.ai

    # Docker image tags (all from GHCR)
    billing_image: ghcr.io/cirisai/cirisbilling:latest
    proxy_image: ghcr.io/cirisai/cirisproxy:latest
    lens_api_image: ghcr.io/cirisai/cirislens-api:latest

    # Service ports
    billing_port: 8080
    proxy_port: 4000
    dns_port: 53
    postgres_port: 5432

    # PostgreSQL (bi-directional replication)
    postgres_version: "16"
    postgres_max_connections: 200
    postgres_shared_buffers: "256MB"
    postgres_replication: bidirectional
    postgres_conflict_resolution: last_write_wins

    # Caddy (TLS)
    caddy_email: admin@ciris.ai

    # CIRISLens (Observability - US node only)
    lens_db_password: "CHANGE_ME"  # TimescaleDB password
    lens_session_secret: "CHANGE_ME"  # Session signing key
    lens_grafana_admin_password: "CHANGE_ME"  # Grafana admin password
    lens_grafana_secret_key: "CHANGE_ME"  # Grafana secret key
    lens_allowed_domain: ciris.ai  # OAuth domain restriction
    lens_public_dashboards: false  # Set true for anonymous read access
